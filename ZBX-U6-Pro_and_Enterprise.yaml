zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: 441c0cb65c274cc9aca624c11eaf6f5c
      name: 'Templates/Network devices'
  templates:
    - uuid: 5b47d78047fc485eb6f62707d872a016
      template: 'Ubiquiti U6-Pro-Enterprise'
      name: 'Ubiquiti U6-Pro-Enterprise'
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: fe88ae8f6b82415996f80bb7ba02008a
          name: Ping
          type: SIMPLE
          key: icmpping
          history: 7d
          tags:
            - tag: Monitoring
              value: Ping
          triggers:
            - uuid: 4391b953e35e42b0a7096dd08bb29869
              expression: 'max(/Ubiquiti U6-Pro-Enterprise/icmpping,#3)=0'
              name: 'Device Unavailable (Ping Failed)'
              priority: DISASTER
              tags:
                - tag: Monitoring
                  value: Ping
        - uuid: 2bfa689339bb47079a9fc5f1e68da0cb
          name: 'Network Conflict Detection'
          type: DEPENDENT
          key: net.conflict.detection
          history: 7d
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var ipMap = {};
                  var macMap = {};
                  var conflicts = [];
                  
                  if (data.port_table) {
                      data.port_table.forEach(function(p) {
                          if (p.mac_table) {
                              p.mac_table.forEach(function(m) {
                                  if (m.ip && m.mac && m.ip !== '0.0.0.0') {
                                      if (!ipMap[m.ip]) ipMap[m.ip] = [];
                                      ipMap[m.ip].push({mac: m.mac, port: p.port_idx});
                                      
                                      if (!macMap[m.mac]) macMap[m.mac] = [];
                                      var seen = false;
                                      macMap[m.mac].forEach(function(mp){ if(mp == p.port_idx) seen=true; });
                                      if (!seen) macMap[m.mac].push(p.port_idx);
                                  }
                              });
                          }
                      });
                  }
                  
                  for (var ip in ipMap) {
                      var entries = ipMap[ip];
                      var uniqueMacs = [];
                      entries.forEach(function(e) { 
                          if (uniqueMacs.indexOf(e.mac) === -1) uniqueMacs.push(e.mac); 
                      });
                      if (uniqueMacs.length > 1) {
                          conflicts.push("IP Conflict: " + ip + " used by MACs: " + uniqueMacs.join(', '));
                      }
                  }
                  
                  for (var mac in macMap) {
                      var ports = macMap[mac];
                      if (ports.length > 1) {
                          conflicts.push("MAC Conflict: " + mac + " seen on multiple ports: " + ports.join(', '));
                      }
                  }
                  
                  return conflicts.length > 0 ? conflicts.join('\n') : "OK";
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'IP Conflict'
          triggers:
            - uuid: 9b8e1afd456d4459b3bd4df138d6c3a1
              expression: 'last(/Ubiquiti U6-Pro-Enterprise/net.conflict.detection)<>"OK"'
              name: 'Network Conflict Detected'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Security
        - uuid: 813083b13f524c0e9e170c0b8209cdda
          name: 'Wired Interface Stats (JSON)'
          type: DEPENDENT
          key: net.if.stats.json
          history: '0'
          value_type: TEXT
          description: 'Normalizes port_table (Switch chip) and if_table (SoC/Linux) differences.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var ports = [];
                  // Case 1: Standard UniFi Switch / UAC-Pro (has port_table)
                  if (data.port_table && data.port_table.length > 0) {
                      return JSON.stringify(data.port_table);
                  }
                  // Case 2: U6-Pro / SoC Models (has if_table)
                  else if (data.if_table && data.if_table.length > 0) {
                      ports = data.if_table.map(function(intf) {
                          // FIX: Use num_port (1) instead of name (eth0) to match LLDP local_port_idx
                          intf.port_idx = (intf.num_port !== undefined) ? intf.num_port : intf.name;
                          // Convert boolean 'up' to 1/0
                          intf.up = (intf.up === true) ? 1 : 0;
                          // Fill missing counters with 0
                          if (intf.rx_broadcast === undefined) intf.rx_broadcast = 0;
                          if (intf.tx_broadcast === undefined) intf.tx_broadcast = 0;
                          if (intf.tx_multicast === undefined) intf.tx_multicast = 0;
                          if (intf.stp_state === undefined) intf.stp_state = 'unknown';
                          return intf;
                      });
                      return JSON.stringify(ports);
                  }
                  return '[]';
          master_item:
            key: 'ssh.run[mca_dump]'
        - uuid: ec7b59e5616e4810abdf85a70a7b7959
          name: 'SSH: Get mca-dump (Master)'
          type: SSH
          key: 'ssh.run[mca_dump]'
          delay: 5m
          history: '0'
          value_type: TEXT
          params: mca-dump
          username: '{$SSH_UNIFI_USER}'
          password: '{$SSH_UNIFI_PASSWORD}'
          description: 'Master item: lekéri a teljes switch állapotot JSON-ben.'
        - uuid: 708d3c6339a445d5aba21660b9b5237b
          name: 'System: Contact'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.4.0
          key: system.contact
          delay: 1h
          history: 7d
          value_type: CHAR
          description: 'Kapcsolattartó információ (SysContact).'
          inventory_link: CONTACT
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: 6ab9598385774b93bd625b328962740e
          name: 'System: CPU Usage'
          type: DEPENDENT
          key: system.cpu.util
          history: 7d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''system-stats''].cpu'
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: CPU
          triggers:
            - uuid: b7530390a8fd4519aa005dd791f1e791
              expression: 'min(/Ubiquiti U6-Pro-Enterprise/system.cpu.util,5m)>90'
              name: 'High CPU usage (>90%)'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: 'CPU Usage'
        - uuid: 224a8592a5ad4229a5c2c1f94e2f9317
          name: 'Inventory: Model'
          type: DEPENDENT
          key: system.hw.model
          history: 7d
          value_type: CHAR
          inventory_link: TYPE
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.model
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: 01f7c369e75a4a479cb6eebfeddd83a0
          name: 'Inventory: Serial Number'
          type: DEPENDENT
          key: system.hw.serial
          history: 7d
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.serial
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: b3b2a759edf24eb9b0d5a06a6e959659
          name: 'System: Location'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.6.0
          key: system.location
          delay: 1h
          history: 7d
          value_type: CHAR
          description: 'A fizikai helyszín leírása (SysLocation).'
          inventory_link: LOCATION
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: ef5c517aa2274cd29e129ade9bcdd846
          name: 'System: Location Latitude'
          type: DEPENDENT
          key: system.location.lat
          history: 7d
          value_type: CHAR
          inventory_link: LOCATION_LAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'LAT:([0-9.]+)'
                - \1
          master_item:
            key: system.location
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: 5c07cff7cf5e45fdad62e2d3fdc14e83
          name: 'System: Location Longitude'
          type: DEPENDENT
          key: system.location.long
          history: 7d
          value_type: CHAR
          inventory_link: LOCATION_LON
          preprocessing:
            - type: REGEX
              parameters:
                - 'LONG:([0-9.]+)'
                - \1
          master_item:
            key: system.location
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: 45cf272f2ac64d51857403151ecaa0b7
          name: 'System: MAC Address Table Size'
          type: DEPENDENT
          key: system.mac.table.size
          history: 7d
          value_type: FLOAT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  
                  var data = JSON.parse(value);
                  // Case 1: Direct value exists (Legacy devices)
                  if (data.total_mac_in_used !== undefined) {
                      return data.total_mac_in_used;
                  }
                  
                  var count = 0;
                  
                  // Case 2: Count Wired Clients
                  if (data.port_table) {
                      for (var i = 0; i < data.port_table.length; i++) {
                          if (data.port_table[i].mac_table) {
                              count += data.port_table[i].mac_table.length;
                          }
                      }
                  }
                  
                  // Case 3: Count Wireless Clients (U6/VAP)
                  if (data.vap_table) {
                      for (var i = 0; i < data.vap_table.length; i++) {
                          if (data.vap_table[i].sta_table) {
                              count += data.vap_table[i].sta_table.length;
                          }
                      }
                  }
                  
                  return count;
                  
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: ARP
          triggers:
            - uuid: e340790a73ba4b3983fabb56c5dc13d7
              expression: 'last(/Ubiquiti U6-Pro-Enterprise/system.mac.table.size) > 14400'
              name: 'MAC Address Table is nearly full (>90%)'
              priority: HIGH
              description: 'The switch MAC address table is over 90% full (Threshold: 14400 / 16000). A full MAC table causes the switch to act like a hub (flooding packets), reducing performance and security.'
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: ARP
            - uuid: 64576b63c89a481982d80272150db37a
              expression: 'last(/Ubiquiti U6-Pro-Enterprise/system.mac.table.size) > 12800'
              name: 'MAC Address Table usage is high (>80%)'
              priority: WARNING
              description: 'The switch MAC address table is over 80% full (Threshold: 12800 / 16000).'
              manual_close: 'YES'
              dependencies:
                - name: 'MAC Address Table is nearly full (>90%)'
                  expression: 'last(/Ubiquiti U6-Pro-Enterprise/system.mac.table.size) > 14400'
              tags:
                - tag: Monitoring
                  value: ARP
        - uuid: dd1a8039e1ee405e9d7715d854d7a490
          name: 'System: Hostname (SNMP)'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 1h
          history: 7d
          value_type: CHAR
          inventory_link: NAME
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: ae6aa9a8219546d2a53871026aa95410
          name: 'Inventory: Firmware Version'
          type: DEPENDENT
          key: system.sw.version
          history: 7d
          value_type: CHAR
          inventory_link: OS
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.version
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: 14abd03ab82045bb98cb469bebe3165a
          name: 'Environment: Detected Neighbor APs (Rogue)'
          type: DEPENDENT
          key: u6.scan.neighbors.count
          value_type: FLOAT
          description: 'Number of other APs detected during background scanning.'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.scan_radio_table.length()
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Rouge AP-s'
        - uuid: 18234eb0974541cf8b078b9011997e47
          name: 'Spectrum: 5GHz Channels Available'
          type: DEPENDENT
          key: u6.spectrum.5ghz.count
          value_type: FLOAT
          description: 'Number of available 5GHz channels (including DFS).'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'var d=JSON.parse(value); return (d.active_chanlist && d.active_chanlist.channels_na) ? d.active_chanlist.channels_na.length : 0;'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Wireless Spectrum'
        - uuid: 8da68bd848f540a082539bcdd0fae47c
          name: 'Spectrum: 6GHz Channels Available'
          type: DEPENDENT
          key: u6.spectrum.6ghz.count
          value_type: FLOAT
          description: 'Number of available 6GHz (WiFi 6E) channels.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'var d=JSON.parse(value); return (d.active_chanlist && d.active_chanlist.channels_6e) ? d.active_chanlist.channels_6e.length : 0;'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Wireless Spectrum'
        - uuid: 55da82b87c034daaaee810a1dc7870f5
          name: 'Spectrum: 2.4GHz Channels Available'
          type: DEPENDENT
          key: u6.spectrum.24ghz.count
          value_type: FLOAT
          description: 'Number of available 2.4GHz channels.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'var d=JSON.parse(value); return (d.active_chanlist && d.active_chanlist.channels_ng) ? d.active_chanlist.channels_ng.length : 0;'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Wireless Spectrum'
        - uuid: 5c5e3261ea744a4e9db6319f0f18ed67
          name: 'Spectrum: 160MHz Channels Available'
          type: DEPENDENT
          key: u6.spectrum.160mhz.count
          value_type: FLOAT
          description: 'Number of available 160MHz channels (DFS dependent).'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - 'var d=JSON.parse(value); return (d.active_chanlist && d.active_chanlist.channels_na_160) ? d.active_chanlist.channels_na_160.length : 0;'
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Wireless Spectrum'
        - uuid: 748ff801be3844aabb9e25803c68c00d
          name: 'System: Isolated Status'
          type: DEPENDENT
          key: u6.system.isolated
          history: 7d
          value_type: FLOAT
          description: 'Isolation status (true = isolated/disconnected).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.isolated
            - type: BOOL_TO_DECIMAL
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: Management
          triggers:
            - uuid: fa5e77aec1ca45ea86e9a0c85d6f6d05
              expression: 'last(/Ubiquiti U6-Pro-Enterprise/u6.system.isolated)=1'
              name: 'Device is Isolated (No Uplink)'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Status
        - uuid: 5c7577f2c2fc4613aa2835bc7c88051f
          name: 'System: Load Average (1m)'
          type: DEPENDENT
          key: 'u6.system.load[1]'
          value_type: FLOAT
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_1
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Load Average'
        - uuid: de03238f2c454dea9c6ebad0370b0c5a
          name: 'System: Load Average (5m)'
          type: DEPENDENT
          key: 'u6.system.load[5]'
          value_type: FLOAT
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_5
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Load Average'
        - uuid: 0cf20f8f89c4449f8cea941623e9bc1a
          name: 'System: Load Average (15m)'
          type: DEPENDENT
          key: 'u6.system.load[15]'
          value_type: FLOAT
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_15
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Load Average'
        - uuid: 98f6c3ae6aea4619b20e14f9107f81e6
          name: 'System: Uplink Interface'
          type: DEPENDENT
          key: u6.system.uplink.if
          history: 7d
          value_type: CHAR
          description: 'Current Uplink Interface (should be eth0 for wired).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.uplink
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: Management
          triggers:
            - uuid: 7cf6ba22500e498387a03c4fd8dbc42e
              expression: 'find(/Ubiquiti U6-Pro-Enterprise/u6.system.uplink.if,,"like","eth0")=0'
              name: 'Device Uplink is NOT Wired (Mesh Mode?)'
              priority: WARNING
              description: 'The uplink interface is not eth0. The AP might be in Wireless Uplink (Mesh) mode.'
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Status
        - uuid: b57f5b610c6f4be597688d0403f42849
          name: 'WLAN Clients: WiFi 5 (11ac)'
          type: DEPENDENT
          key: 'u6.wlan.clients.count[ac]'
          value_type: FLOAT
          description: 'Number of clients connected using WiFi 5 (11ac).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.ac
          master_item:
            key: u6.wlan.clients.distribution.json
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: 26b2b9036d344f6cbc1ea3509d4af2f9
          name: 'WLAN Clients: WiFi 6 (11ax)'
          type: DEPENDENT
          key: 'u6.wlan.clients.count[ax]'
          value_type: FLOAT
          description: 'Number of clients connected using WiFi 6 (11ax).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.ax
          master_item:
            key: u6.wlan.clients.distribution.json
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: 97812abc4db74d5ba47de2c6107f6767
          name: 'WLAN Clients: Legacy (11a/b/g)'
          type: DEPENDENT
          key: 'u6.wlan.clients.count[legacy]'
          value_type: FLOAT
          description: 'Number of clients connected using Legacy (11a/b/g).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.legacy
          master_item:
            key: u6.wlan.clients.distribution.json
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: b5bdc9aad1cc42b2814c720071cf6e74
          name: 'WLAN Clients: WiFi 4 (11n)'
          type: DEPENDENT
          key: 'u6.wlan.clients.count[n]'
          value_type: FLOAT
          description: 'Number of clients connected using WiFi 4 (11n).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.n
          master_item:
            key: u6.wlan.clients.distribution.json
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: 0e0a67b551bd4b68b65d9cb3f2e25a9d
          name: 'WLAN: Client Technology Distribution (JSON)'
          type: DEPENDENT
          key: u6.wlan.clients.distribution.json
          history: '0'
          value_type: TEXT
          description: 'Helper item to count clients by WiFi generation.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var s = {ax:0, ac:0, n:0, legacy:0, total:0};
                  if(data.vap_table){
                    data.vap_table.forEach(function(v){
                      if(v.sta_table){
                        v.sta_table.forEach(function(c){
                          s.total++;
                          if(c.is_11ax) s.ax++;
                          else if(c.is_11ac) s.ac++;
                          else if(c.is_11n) s.n++;
                          else s.legacy++;
                        });
                      }
                    });
                  }
                  return JSON.stringify(s);
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: 0198b816b2be4c8f9844fe24c34feeb3
          name: 'Management: Controller Connection State'
          type: DEPENDENT
          key: unifi.controller.state
          history: 7d
          value_type: FLOAT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.state
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 10m
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: Management
          triggers:
            - uuid: 7a042a389ae04e67bec2a92eb2c4eabc
              expression: 'last(/Ubiquiti U6-Pro-Enterprise/unifi.controller.state)<>2'
              name: 'Device Disconnected from Controller (State is not Provisioned)'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Management
        - uuid: 91914ddbb75f44769e344033fd9e05c9
          name: 'Management: Controller URL'
          type: DEPENDENT
          key: unifi.inform.url
          history: 7d
          value_type: CHAR
          description: 'Inform URL'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.inform_url
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: Management
        - uuid: 667b92373d774293ae505430e6446524
          name: 'System: Memory Used'
          type: DEPENDENT
          key: vm.memory.util
          history: 7d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var used = data.sys_stats.mem_used;
                  var total = data.sys_stats.mem_total;
                  return (used / total) * 100;
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Memory Usage'
      discovery_rules:
        - uuid: 98f0b5c8c5674c0299e02fc24f470823
          name: 'Port Discovery (mca-dump)'
          type: DEPENDENT
          key: net.if.discovery.mca
          item_prototypes:
            - uuid: 5e0749a45fac44a9af840daf3757519f
              name: 'Interface Port {#IFNAME}: LLDP Remote Chassis ID'
              type: DEPENDENT
              key: 'lldp.chassis[{#IFNAME}]'
              history: 7d
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.lldp_table[?(@.local_port_idx==''{#IFNAME}'')].chassis_id.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Neighbors'
            - uuid: b90c2089370c491b862ea15960e02c4b
              name: 'Interface Port {#IFNAME}: LLDP Remote Port ID'
              type: DEPENDENT
              key: 'lldp.port[{#IFNAME}]'
              history: 7d
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.lldp_table[?(@.local_port_idx==''{#IFNAME}'')].port_id.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Neighbors'
            - uuid: 25541b09eaf94d78b88d5cb375d518d0
              name: 'Interface Port {#IFNAME}: Inbound Multicast Packets'
              type: DEPENDENT
              key: 'net.if.in.multicast[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: pps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.port_idx==''{#IFNAME}'')].rx_multicast.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-1'
              master_item:
                key: net.if.stats.json
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic Types'
            - uuid: ddecf67dc6b24714a9525e7fd0a74622
              name: 'Interface Port {#IFNAME}: Inbound Traffic'
              type: DEPENDENT
              key: 'net.if.in[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.port_idx==''{#IFNAME}'')].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-8'
              master_item:
                key: net.if.stats.json
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic'
            - uuid: a554ab55ae4a4885bb4c211f3a03f251
              name: 'Interface Port {#IFNAME}: Outbound Dropped Packets'
              type: DEPENDENT
              key: 'net.if.out.dropped[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.port_idx==''{#IFNAME}'')].tx_dropped.first()'
                - type: CHANGE_PER_SECOND
              master_item:
                key: net.if.stats.json
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Errors'
            - uuid: 296603d76b824bebbf410b8eaec4b311
              name: 'Interface Port {#IFNAME}: Outbound Errors'
              type: DEPENDENT
              key: 'net.if.out.errors[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.port_idx==''{#IFNAME}'')].tx_errors.first()'
                - type: CHANGE_PER_SECOND
              master_item:
                key: net.if.stats.json
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Errors'
            - uuid: 924c11173a8942c69fdc73efd126558b
              name: 'Interface Port {#IFNAME}: Outbound Multicast Packets'
              type: DEPENDENT
              key: 'net.if.out.multicast[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: pps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.port_idx==''{#IFNAME}'')].tx_multicast.first()'
                - type: CHANGE_PER_SECOND
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '500000000'
              master_item:
                key: net.if.stats.json
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic Types'
            - uuid: 8706e6e53b97408a959146bb08eab243
              name: 'Interface Port {#IFNAME}: Outbound Traffic'
              type: DEPENDENT
              key: 'net.if.out[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.port_idx==''{#IFNAME}'')].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '200000000000'
              master_item:
                key: net.if.stats.json
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic'
            - uuid: c11d33a44ed843d0895e2ca530dbbda8
              name: 'Interface Port {#IFNAME}: Speed'
              type: DEPENDENT
              key: 'net.if.speed[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.port_idx==''{#IFNAME}'')].speed.first()'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: net.if.stats.json
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Speed'
            - uuid: 30f64dde837444ba8c2747a5ff7d1160
              name: 'Interface Port {#IFNAME}: Status'
              type: DEPENDENT
              key: 'net.if.status[{#IFNAME}]'
              history: 7d
              valuemap:
                name: 'Interface Status MCA'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.[?(@.port_idx==''{#IFNAME}'')].up.first()'
                - type: BOOL_TO_DECIMAL
              master_item:
                key: net.if.stats.json
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Status'
              trigger_prototypes:
                - uuid: a3992918fc964af092c838d8164566df
                  expression: 'count(/Ubiquiti U6-Pro-Enterprise/net.if.status[{#IFNAME}],10m,"ne","1") > 5'
                  name: 'Interface {#IFNAME}: Link is flapping'
                  priority: WARNING
          trigger_prototypes:
            - uuid: 53f2d61bd28e4d019a6451105b7b8342
              expression: 'abs(min(/Ubiquiti U6-Pro-Enterprise/net.if.in[{#IFNAME}],5m)) > (last(/Ubiquiti U6-Pro-Enterprise/net.if.speed[{#IFNAME}]) * 0.95) and last(/Ubiquiti U6-Pro-Enterprise/net.if.speed[{#IFNAME}]) > 0'
              name: 'Interface Port {#IFNAME}: Critical Inbound Bandwidth Usage (>95%)'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Bandwidth
            - uuid: bad2f9696a774b77b514814f75a0936c
              expression: 'min(/Ubiquiti U6-Pro-Enterprise/net.if.out[{#IFNAME}],5m) > (last(/Ubiquiti U6-Pro-Enterprise/net.if.speed[{#IFNAME}]) * 0.95) and last(/Ubiquiti U6-Pro-Enterprise/net.if.speed[{#IFNAME}]) > 0'
              name: 'Interface Port {#IFNAME}: Critical Outbound Bandwidth Usage (>95%)'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Bandwidth
            - uuid: cf997335f28540ec8cbd18d39fd97b72
              expression: 'abs(min(/Ubiquiti U6-Pro-Enterprise/net.if.in[{#IFNAME}],5m)) > (last(/Ubiquiti U6-Pro-Enterprise/net.if.speed[{#IFNAME}]) * 0.85) and last(/Ubiquiti U6-Pro-Enterprise/net.if.speed[{#IFNAME}]) > 0'
              name: 'Interface Port {#IFNAME}: High Inbound Bandwidth Usage (>85%)'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Bandwidth
            - uuid: 5ed95447f17e4be086c92b7da778db1a
              expression: 'min(/Ubiquiti U6-Pro-Enterprise/net.if.out[{#IFNAME}],5m) > (last(/Ubiquiti U6-Pro-Enterprise/net.if.speed[{#IFNAME}]) * 0.85) and last(/Ubiquiti U6-Pro-Enterprise/net.if.speed[{#IFNAME}]) > 0'
              name: 'Interface Port {#IFNAME}: High Outbound Bandwidth Usage (>85%)'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Bandwidth
          graph_prototypes:
            - uuid: 3077fe7b6c304eaf93f8886ecf76e4de
              name: 'Interface Port {#IFNAME}: Dropped Packets'
              graph_items:
                - sortorder: '1'
                  drawtype: FILLED_REGION
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'net.if.out.dropped[{#IFNAME}]'
            - uuid: 41f63c939cce4ef599eaa54566828214
              name: 'Interface Port {#IFNAME}: Traffic'
              graph_items:
                - drawtype: FILLED_REGION
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'net.if.in[{#IFNAME}]'
                - sortorder: '1'
                  drawtype: FILLED_REGION
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'net.if.out[{#IFNAME}]'
            - uuid: 47f4e34fc04444d38288f20fdced0ceb
              name: 'Interface Port {#IFNAME}: Traffic Types'
              yaxismax: '0'
              show_work_period: 'NO'
              show_triggers: 'NO'
              graph_items:
                - sortorder: '1'
                  color: FFBF00
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'net.if.in.multicast[{#IFNAME}]'
                - sortorder: '4'
                  color: FFBF00
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'net.if.out.multicast[{#IFNAME}]'
          master_item:
            key: net.if.stats.json
          lld_macro_paths:
            - lld_macro: '{#IFALIAS}'
              path: $.name
            - lld_macro: '{#IFNAME}'
              path: $.port_idx
        - uuid: 95d433da22ff4b13b436857dc18cf95c
          name: 'Device Tracking Discovery (ARP/IP)'
          type: DEPENDENT
          key: net.tracking.discovery
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: c3d1734090be42589279048e3c383ded
              name: 'Device on Port {#PORT_IDX}: {#IP_ADDR}'
              type: DEPENDENT
              key: 'net.tracking.device[{#PORT_IDX},{#IP_ADDR},{#MAC_ADDR}]'
              history: '0'
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx=={#PORT_IDX})].mac_table[?(@.ip==''{#IP_ADDR}'' && @.mac==''{#MAC_ADDR}'')].mac.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: ARP
                - tag: Monitoring
                  value: 'Device Tracking'
          master_item:
            key: 'ssh.run[mca_dump]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var output = [];
                  if (data.port_table) {
                      data.port_table.forEach(function(port) {
                          if (port.mac_table) {
                              port.mac_table.forEach(function(entry) {
                                  if (entry.ip && entry.ip !== '0.0.0.0') {
                                      output.push({
                                          '{#PORT_IDX}': port.port_idx,
                                          '{#IP_ADDR}': entry.ip,
                                          '{#MAC_ADDR}': entry.mac,
                                          '{#VLAN_ID}': entry.vlan
                                      });
                                  }
                              });
                          }
                      });
                  }
                  return JSON.stringify(output);
        - uuid: 2e8671b9867746f2b9a675385c0c7117
          name: 'Radio Discovery (Physical)'
          type: DEPENDENT
          key: u6.radio.discovery
          item_prototypes:
            - uuid: ff6e4362adea43319586be6c21312a7a
              name: 'Radio {#RADIO}: Current Channel'
              type: DEPENDENT
              key: 'u6.radio.channel[{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var rName = '{#RADIO}';
                      var val = 0;
                      
                      // Try Radio Table first (Legacy)
                      if (data.radio_table) {
                          for (var i = 0; i < data.radio_table.length; i++) {
                              if (data.radio_table[i].name === rName && data.radio_table[i].channel !== undefined) {
                                  val = data.radio_table[i].channel;
                                  return val;
                              }
                          }
                      }
                      
                      // Fallback to VAP Table (U6 Firmware)
                      if (data.vap_table) {
                          for (var i = 0; i < data.vap_table.length; i++) {
                              // Check both 'radio_name' (e.g. wifi0) and 'radio' (e.g. ng/na)
                              // Usually 'radio_name' matches {#RADIO} which is 'wifi0'
                              if (data.vap_table[i].radio_name === rName || data.vap_table[i].radio === rName) {
                                  if (data.vap_table[i].channel !== undefined) {
                                      val = data.vap_table[i].channel;
                                      return val; 
                                  }
                              }
                          }
                      }
                      return val;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Radio Configuration'
            - uuid: c0484ed48f5243c5a72e7dd2eca1c4ce
              name: 'Radio {#RADIO}: EIRP (Total Radiated Power)'
              type: DEPENDENT
              key: 'u6.radio.eirp[{#RADIO}]'
              value_type: FLOAT
              units: dBm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var rName = '{#RADIO}';
                      var tx = 0; 
                      var gain = 0;
                      var foundTx = false;
                      
                      // 1. Try Radio Table for TX Power
                      if (data.radio_table) {
                          for (var i = 0; i < data.radio_table.length; i++) {
                              if (data.radio_table[i].name === rName && data.radio_table[i].tx_power !== undefined) {
                                  tx = data.radio_table[i].tx_power;
                                  foundTx = true;
                                  break;
                              }
                          }
                      }
                      
                      // 2. Fallback: Try VAP Table for TX Power if not found
                      if (!foundTx && data.vap_table) {
                          for (var i = 0; i < data.vap_table.length; i++) {
                              if ((data.vap_table[i].radio_name === rName || data.vap_table[i].radio === rName) && data.vap_table[i].tx_power !== undefined) {
                                  tx = data.vap_table[i].tx_power;
                                  foundTx = true;
                                  break; 
                              }
                          }
                      }
                      
                      // 3. Get Antenna Gain
                      if (data.antenna_table && data.antenna_table[0]) {
                          var key = rName + '_gain';
                          if (data.antenna_table[0][key] !== undefined) {
                              gain = data.antenna_table[0][key];
                          }
                      }
                      
                      return tx + gain;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Radio Performance'
            - uuid: 73fe337b64884d6b92ddf78bb32b1020
              name: 'Radio {#RADIO}: Channel Utilization (Total)'
              type: DEPENDENT
              key: 'u6.radio.utilization[{#RADIO}]'
              value_type: FLOAT
              units: '%'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var rName = '{#RADIO}';
                      var val = 0;
                      var radio = data.radio_table.find(function(r){ return r.name === rName });
                      if (radio && radio.cu_total !== undefined) {
                          val = radio.cu_total;
                      }
                      return val;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Radio Performance'
          graph_prototypes:
            - uuid: dc6d5111d8e342928eaab5b178653734
              name: 'Radio {#RADIO}: Channel Utilization (Total)'
              yaxismax: '0'
              graph_items:
                - drawtype: FILLED_REGION
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.radio.utilization[{#RADIO}]'
            - uuid: 91f3fc1a6657464ca37e044be06b7e30
              name: 'Radio {#RADIO}: Current Channel'
              graph_items:
                - drawtype: DOTTED_LINE
                  color: 1A7C11
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.radio.channel[{#RADIO}]'
            - uuid: 067e43b71b864443b23b308f2783da7d
              name: 'Radio {#RADIO}: EIRP (Total Radiated Power)'
              yaxismax: '0'
              graph_items:
                - drawtype: FILLED_REGION
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.radio.eirp[{#RADIO}]'
          master_item:
            key: 'ssh.run[mca_dump]'
          lld_macro_paths:
            - lld_macro: '{#RADIO}'
              path: $.name
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.radio_table[:]'
        - uuid: df3a4711c6b04d2488a900aba32b93e5
          name: 'SSID (VAP) Discovery'
          type: DEPENDENT
          key: u6.vap.discovery
          item_prototypes:
            - uuid: af117d39044343f0aef05c2456a746f3
              name: 'Inbound Traffic on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'net.vap.in[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-8'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Traffic'
            - uuid: bfd20845a2f4437299547c01dba7bbd8
              name: 'Outbound Traffic on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'net.vap.out[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Traffic'
            - uuid: c9bd05edfab847b88deacbec15d49e48
              name: 'Anomaly: ARP Timeout on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.arp_timeout[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma, akik nem kapnak választ ARP kérésre (sta_arp_timeout). Gateway probléma lehet.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.sta_arp_timeout.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 600fad7232ac45af8ad3c2432652cb21
                  expression: 'min(/Ubiquiti U6-Pro-Enterprise/u6.vap.anomaly.arp_timeout[{#ESSID},{#RADIO}],5m)>0'
                  name: 'Network Issue ({#ESSID}): ARP Timeout (Gateway unreachable?)'
                  priority: HIGH
            - uuid: 17c09020a07a494aab1b634c435e0355
              name: 'DHCP Failures on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.dhcp[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.no_dhcp_response.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 865cc302a43c4ad1952cb5e6bfc0b267
                  expression: 'min(/Ubiquiti U6-Pro-Enterprise/u6.vap.anomaly.dhcp[{#ESSID},{#RADIO}],5m)>0'
                  name: 'DHCP Issue on WiFi ({#ESSID}): Clients not receiving IP'
                  priority: DISASTER
                  manual_close: 'YES'
            - uuid: 87280881364b4dde8a1321cd38415a0f
              name: 'Anomaly: High Disconnect Count on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.disconnects[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Gyakori lecsatlakozások száma (high_disconnect_count).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_disconnect_count.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 7a79a551a12e488f9b7d9fc3b2896191
              name: 'High DNS Latency on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.dns[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_dns_latency.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: bc92fc9c60fa4e4492231567aa4d70fe
                  expression: 'min(/Ubiquiti U6-Pro-Enterprise/u6.vap.anomaly.dns[{#ESSID},{#RADIO}],5m)>0'
                  name: 'High DNS Latency on {#ESSID} ({#RADIO})'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 7a2fb2e1d9654dd8ac2dc5f254c469ea
              name: 'Anomaly: DNS Timeout on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.dns_timeout[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma, akik egyáltalán nem kapnak választ a DNS szervertől (sta_dns_timeout).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.sta_dns_timeout.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 658e6d4380a844cd99d344425d8cfe6e
              name: 'High ICMP Latency on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.icmp[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_icmp_rtt.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 9759fe3fc11447a8be710a99326702c0
                  expression: 'min(/Ubiquiti U6-Pro-Enterprise/u6.vap.anomaly.icmp[{#ESSID},{#RADIO}],5m)>0'
                  name: 'High ICMP Latency on {#ESSID} ({#RADIO})'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 4691a1ac638b4f0f81e8ca9f02fbd41d
              name: 'Anomaly: Low PHY Rate on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.low_phy[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma nagyon alacsony fizikai kapcsolati sebességgel (low_phy_rate).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.low_phy_rate.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: acd85e51425e485ca3623443dda407b1
              name: 'Anomaly: Sleepy Clients on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.sleepy[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek, amelyek energiatakarékos módban ragadtak vagy nem válaszolnak (sleepy_client).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.sleepy_client.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: b943d833e938456294ad9e682cd97994
              name: 'Anomaly: High TCP Latency on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.tcp_latency[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma magas TCP késleltetéssel. Ez lassú webböngészést okoz.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_tcp_latency.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: a17e26ec06ee4596bb43b7655c2053e6
              name: 'Anomaly: TCP Packet Loss on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.tcp_loss[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma TCP csomagvesztéssel (high_tcp_packet_loss).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_tcp_packet_loss.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: d7a72e8777864f6889478cbb08729c2d
              name: 'Weak Signal Clients on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.weak_signal[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.weak_signal.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 70420b5d36cc4b90ba8dcbd6ca867d5c
                  expression: 'last(/Ubiquiti U6-Pro-Enterprise/u6.vap.anomaly.weak_signal[{#ESSID},{#RADIO}],#5)>5'
                  name: 'Weak Signal Clients on {#ESSID} ({#RADIO}'
                  priority: INFO
            - uuid: 48b2c4277e884f269d9905a7310f5f39
              name: 'Anomaly: WiFi Drops on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.wifi_drops[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Azon kliensek száma, akiknél a Wi-Fi kapcsolat váratlanul megszakadt (high_wifi_drops).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_wifi_drops.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 2d29c10fb9ec4f749076a03f7a2307e4
                  expression: 'min(/Ubiquiti U6-Pro-Enterprise/u6.vap.anomaly.wifi_drops[{#ESSID},{#RADIO}],5m)>2'
                  name: 'Unstable WiFi ({#ESSID}): Multiple Clients Dropping Connection'
                  priority: HIGH
                  manual_close: 'YES'
            - uuid: 18781c17261946158e7c939744673991
              name: 'Anomaly: High WiFi Retries on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.wifi_retries[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma magas újraküldési aránnyal (high_wifi_retries). Ez erős interferenciára vagy távoli kliensekre utal.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_wifi_retries.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 341b0c69ca4f4beaa53f8c035c20d519
              name: 'Clients on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.clients[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].num_sta.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: SSID
                - tag: Monitoring
                  value: 'Wireless Clients'
            - uuid: 74b5d5cc0b8242d3b8335f18df39387a
              name: 'Satisfaction Score on {#ESSID}'
              type: DEPENDENT
              key: 'u6.vap.satisfaction[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].satisfaction.first()'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: SSID
          graph_prototypes:
            - uuid: 4dc80c3f80d3448589512c278f274c0c
              name: 'Anomalies on {#ESSID} ({#RADIO})'
              yaxismax: '0'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.arp_timeout[{#ESSID},{#RADIO}]'
                - sortorder: '1'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.dns_timeout[{#ESSID},{#RADIO}]'
                - sortorder: '2'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.disconnects[{#ESSID},{#RADIO}]'
                - sortorder: '3'
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.tcp_latency[{#ESSID},{#RADIO}]'
                - sortorder: '4'
                  color: A54F10
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.wifi_retries[{#ESSID},{#RADIO}]'
                - sortorder: '5'
                  color: FC6EA3
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.low_phy[{#ESSID},{#RADIO}]'
                - sortorder: '6'
                  color: 6C59DC
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.sleepy[{#ESSID},{#RADIO}]'
                - sortorder: '7'
                  color: AC8C14
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.tcp_loss[{#ESSID},{#RADIO}]'
                - sortorder: '8'
                  color: 611F27
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.wifi_drops[{#ESSID},{#RADIO}]'
                - sortorder: '9'
                  color: F230E0
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.dhcp[{#ESSID},{#RADIO}]'
                - sortorder: '10'
                  color: 5CCD18
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.dns[{#ESSID},{#RADIO}]'
                - sortorder: '11'
                  color: BB2A02
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.anomaly.icmp[{#ESSID},{#RADIO}]'
            - uuid: a08d5c636a174fe2b9a6a63ec23c05ae
              name: 'Satisfaction Score on {#ESSID}'
              yaxismax: '0'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'u6.vap.satisfaction[{#ESSID},{#RADIO}]'
            - uuid: 71e2eac4e05847f29be09e796b022ce2
              name: 'Traffic on {#ESSID} ({#RADIO})'
              yaxismax: '0'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'net.vap.in[{#ESSID},{#RADIO}]'
                - sortorder: '1'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-Pro-Enterprise'
                    key: 'net.vap.out[{#ESSID},{#RADIO}]'
          master_item:
            key: 'ssh.run[mca_dump]'
          lld_macro_paths:
            - lld_macro: '{#APMAC}'
              path: $.bssid
            - lld_macro: '{#ESSID}'
              path: $.essid
            - lld_macro: '{#RADIO}'
              path: $.radio
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.vap_table[:]'
      valuemaps:
        - uuid: 386b1f39f54d4cfcaacc1d17a20ba6f4
          name: 'Interface Status'
          mappings:
            - value: '1'
              newvalue: Up
            - value: '2'
              newvalue: Down
            - value: '3'
              newvalue: Testing
        - uuid: 234131b873fb4a61873b1d1f851cab81
          name: 'Interface Status MCA'
          mappings:
            - value: '1'
              newvalue: Up
            - value: '0'
              newvalue: Down
  graphs:
    - uuid: c28a01b316cc44dea70561a97dc06369
      name: 'CPU Usage'
      yaxismax: '0'
      graph_items:
        - drawtype: FILLED_REGION
          color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: system.cpu.util
    - uuid: 36bd3e4db48643b1a126f0b3c14ca091
      name: 'Load AVG'
      yaxismax: '0'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: 'u6.system.load[1]'
        - sortorder: '1'
          color: '274482'
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: 'u6.system.load[5]'
        - sortorder: '2'
          color: F63100
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: 'u6.system.load[15]'
    - uuid: b97480e00d944ca5ad3046c502f59f9c
      name: 'Mac Address Table Size'
      yaxismax: '0'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: system.mac.table.size
    - uuid: 6f2a7c960a1849a4acf4362eef0d494e
      name: 'Memory Usage'
      yaxismax: '0'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: vm.memory.util
    - uuid: f9a3d757569c4aa28972d754d70ab797
      name: Ping
      yaxismax: '0'
      graph_items:
        - drawtype: FILLED_REGION
          color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: icmpping
    - uuid: 50818d0c4df145e9bbc87fd7664d8212
      name: 'Wireless Clients Via Technology'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: 'u6.wlan.clients.count[legacy]'
        - sortorder: '1'
          color: '274482'
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: 'u6.wlan.clients.count[n]'
        - sortorder: '2'
          color: F63100
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: 'u6.wlan.clients.count[ac]'
        - sortorder: '3'
          color: FFBF00
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-Pro-Enterprise'
            key: 'u6.wlan.clients.count[ax]'
