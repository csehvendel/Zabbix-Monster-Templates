zabbix_export:
  version: '7.4'
  template_groups:
    - uuid: 441c0cb65c274cc9aca624c11eaf6f5c
      name: 'Templates/Network devices'
  templates:
    - uuid: 93e98daef54d4928ae0a35c38d2c0acb
      template: 'Ubiquiti U6-IW'
      name: 'Ubiquiti U6-IW'
      groups:
        - name: 'Templates/Network devices'
      items:
        - uuid: 5e94b1f9832744119cefdf810a701e07
          name: Ping
          type: SIMPLE
          key: icmpping
          history: 7d
          tags:
            - tag: Monitoring
              value: Ping
          triggers:
            - uuid: 86c20bc6f0ae4a19af50baaa9e2e2569
              expression: 'max(/Ubiquiti U6-IW/icmpping,#3)=0'
              name: 'Device Unavailable (Ping Failed)'
              priority: DISASTER
              tags:
                - tag: Monitoring
                  value: Ping
        - uuid: e0375ed7cfb04d5b926b34c7ad6e392e
          name: 'Network Conflict Detection'
          type: DEPENDENT
          key: net.conflict.detection
          history: 7d
          value_type: TEXT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  
                  var data = JSON.parse(value);
                  var ipMap = {};
                  var macMap = {};
                  var conflicts = [];
                  
                  // Helper function to add clients
                  function addClient(ip, mac, source, vlan) {
                      if (!ip || !mac || ip === '0.0.0.0') return;
                      
                      // IP Conflict Check Map
                      if (!ipMap[ip]) ipMap[ip] = [];
                      ipMap[ip].push({mac: mac, loc: source});
                  
                      // MAC Conflict Check Map
                      if (!macMap[mac]) macMap[mac] = [];
                      // Only add if location is different (avoid dups)
                      var seen = false;
                      for(var i=0; i<macMap[mac].length; i++) {
                          if(macMap[mac][i] === source) seen = true;
                      }
                      if (!seen) macMap[mac].push(source);
                  }
                  
                  // 1. Process Wired Clients
                  if (data.port_table) {
                      for (var i = 0; i < data.port_table.length; i++) {
                          var p = data.port_table[i];
                          if (p.mac_table) {
                              for (var j = 0; j < p.mac_table.length; j++) {
                                  var m = p.mac_table[j];
                                  addClient(m.ip, m.mac, "Port " + p.port_idx, m.vlan);
                              }
                          }
                      }
                  }
                  
                  // 2. Process Wireless Clients
                  if (data.vap_table) {
                      for (var i = 0; i < data.vap_table.length; i++) {
                          var v = data.vap_table[i];
                          if (v.sta_table) {
                              for (var j = 0; j < v.sta_table.length; j++) {
                                  var s = v.sta_table[j];
                                  var loc = (v.essid || "WiFi") + " (" + (v.radio || "?") + ")";
                                  addClient(s.ip, s.mac, loc, s.vlan_id);
                              }
                          }
                      }
                  }
                  
                  // Analyze IP Conflicts
                  for (var ip in ipMap) {
                      var entries = ipMap[ip];
                      var uniqueMacs = [];
                      for(var i=0; i<entries.length; i++) {
                          var mac = entries[i].mac;
                          var exists = false;
                          for(var k=0; k<uniqueMacs.length; k++) if(uniqueMacs[k]===mac) exists=true;
                          if(!exists) uniqueMacs.push(mac);
                      }
                      
                      if (uniqueMacs.length > 1) {
                          conflicts.push("IP Conflict: " + ip + " is used by multiple MACs: " + uniqueMacs.join(', '));
                      }
                  }
                  
                  // Analyze MAC Conflicts (Move)
                  for (var mac in macMap) {
                      var locs = macMap[mac];
                      if (locs.length > 1) {
                          conflicts.push("MAC Move/Loop: " + mac + " seen at multiple locations: " + locs.join(', '));
                      }
                  }
                  
                  return conflicts.length > 0 ? conflicts.join('\n') : "OK";
                  
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'IP Conflict'
          triggers:
            - uuid: 281d114d637542c0aa773d74288e9f7b
              expression: 'last(/Ubiquiti U6-IW/net.conflict.detection)<>"OK"'
              name: 'Network Conflict Detected'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Security
        - uuid: 6e5834c8716b462b917e41d44caddc4e
          name: 'SSH: Get mca-dump (Master)'
          type: SSH
          key: 'ssh.run[mca_dump]'
          delay: 5m
          history: '0'
          value_type: TEXT
          params: mca-dump
          username: '{$SSH_UNIFI_USER}'
          password: '{$SSH_UNIFI_PASSWORD}'
          description: 'Master item: lekéri a teljes switch állapotot JSON-ben.'
        - uuid: 2eb63d457c8f4948965b264b73866743
          name: 'System: Contact'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.4.0
          key: system.contact
          delay: 1h
          history: 7d
          value_type: CHAR
          description: 'Kapcsolattartó információ (SysContact).'
          inventory_link: CONTACT
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: fc0c89102ca3439d956aad32cecc0067
          name: 'System: CPU Usage'
          type: DEPENDENT
          key: system.cpu.util
          history: 7d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.[''system-stats''].cpu'
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: CPU
          triggers:
            - uuid: 8eb50050b64b4b86803e2b1c3a1a8f4a
              expression: 'min(/Ubiquiti U6-IW/system.cpu.util,5m)>90'
              name: 'High CPU usage (>90%)'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: 'CPU Usage'
        - uuid: fae8339a6b7f4fe5af8bd9fddb3712a9
          name: 'Inventory: Model'
          type: DEPENDENT
          key: system.hw.model
          history: 7d
          value_type: CHAR
          inventory_link: TYPE
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.model
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: fdbcc2a8c74e4a5f82503917b5904275
          name: 'Inventory: Serial Number'
          type: DEPENDENT
          key: system.hw.serial
          history: 7d
          value_type: CHAR
          inventory_link: SERIALNO_A
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.serial
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: afcc2b7bd1de4a75bd61169c1e31085a
          name: 'System: Location'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.6.0
          key: system.location
          delay: 1h
          history: 7d
          value_type: CHAR
          description: 'A fizikai helyszín leírása (SysLocation).'
          inventory_link: LOCATION
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: a9c7e5072a444b618ce81e651a0bbe3f
          name: 'System: Location Latitude'
          type: DEPENDENT
          key: system.location.lat
          history: 7d
          value_type: CHAR
          inventory_link: LOCATION_LAT
          preprocessing:
            - type: REGEX
              parameters:
                - 'LAT:([0-9.]+)'
                - \1
          master_item:
            key: system.location
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: e85e24b5ad2a4737a203d09dc9b7f8b2
          name: 'System: Location Longitude'
          type: DEPENDENT
          key: system.location.long
          history: 7d
          value_type: CHAR
          inventory_link: LOCATION_LON
          preprocessing:
            - type: REGEX
              parameters:
                - 'LONG:([0-9.]+)'
                - \1
          master_item:
            key: system.location
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: 37ffd7d8b0ef4e7a80523bfec95350dc
          name: 'System: MAC Address Table Size'
          type: DEPENDENT
          key: system.mac.table.size
          history: 7d
          value_type: FLOAT
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  
                  var data = JSON.parse(value);
                  // Case 1: Direct value exists (Legacy devices) - we use this if available AND if it looks plausible (>1 if we have wifi clients)
                  // BUT, on new firmware, total_mac_in_used might only count wired.
                  // Safe approach: Always recount both to be sure.
                  
                  var count = 0;
                  // Count Wired
                  if (data.port_table) {
                      for (var i = 0; i < data.port_table.length; i++) {
                          if (data.port_table[i].mac_table) {
                              count += data.port_table[i].mac_table.length;
                          }
                      }
                  }
                  // Count Wireless
                  if (data.vap_table) {
                      for (var i = 0; i < data.vap_table.length; i++) {
                          if (data.vap_table[i].sta_table) {
                              count += data.vap_table[i].sta_table.length;
                          }
                      }
                  }
                  return count;
                  
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: ARP
          triggers:
            - uuid: 2cd0dc426dfd4e1080f59feb0be15d45
              expression: 'last(/Ubiquiti U6-IW/system.mac.table.size) > 14400'
              name: 'MAC Address Table is nearly full (>90%)'
              priority: HIGH
              description: 'The switch MAC address table is over 90% full (Threshold: 14400 / 16000). A full MAC table causes the switch to act like a hub (flooding packets), reducing performance and security.'
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: ARP
            - uuid: 5dc59dfe8f0a427880da05d0cd9285f8
              expression: 'last(/Ubiquiti U6-IW/system.mac.table.size) > 12800'
              name: 'MAC Address Table usage is high (>80%)'
              priority: WARNING
              description: 'The switch MAC address table is over 80% full (Threshold: 12800 / 16000).'
              manual_close: 'YES'
              dependencies:
                - name: 'MAC Address Table is nearly full (>90%)'
                  expression: 'last(/Ubiquiti U6-IW/system.mac.table.size) > 14400'
              tags:
                - tag: Monitoring
                  value: ARP
        - uuid: 723c72cd850246c98003e0986c3f5c6c
          name: 'System: Hostname (SNMP)'
          type: SNMP_AGENT
          snmp_oid: .1.3.6.1.2.1.1.5.0
          key: system.name
          delay: 1h
          history: 7d
          value_type: CHAR
          inventory_link: NAME
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: c2207d76341b41a9abfb45b140be1864
          name: 'Inventory: Firmware Version'
          type: DEPENDENT
          key: system.sw.version
          history: 7d
          value_type: CHAR
          inventory_link: OS
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.version
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Hardware
              value: Chassis
        - uuid: 18f9a01729b24a7b92edfe9c579b3b9c
          name: 'System: Isolated Status'
          type: DEPENDENT
          key: u6.system.isolated
          history: 7d
          value_type: FLOAT
          description: 'Isolation status (true = isolated/disconnected).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.isolated
            - type: BOOL_TO_DECIMAL
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: Status
          triggers:
            - uuid: e55c85cf828a4cafbe05fb06562de4ae
              expression: 'last(/Ubiquiti U6-IW/u6.system.isolated)=1'
              name: 'Device is Isolated (No Uplink)'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Status
        - uuid: 74862704ea174d3a9df0d1777e407ea1
          name: 'System: Load Average (1m)'
          type: DEPENDENT
          key: 'u6.system.load[1]'
          value_type: FLOAT
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_1
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Load Average'
        - uuid: 71c854020921434294504093932d894a
          name: 'System: Load Average (5m)'
          type: DEPENDENT
          key: 'u6.system.load[5]'
          value_type: FLOAT
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_5
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Load Average'
        - uuid: 7f3f6ca96b4c450bb7d9e3ac2a1653eb
          name: 'System: Load Average (15m)'
          type: DEPENDENT
          key: 'u6.system.load[15]'
          value_type: FLOAT
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.sys_stats.loadavg_15
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Load Average'
        - uuid: ba3bb33ff63444109714d0eb2013610e
          name: 'System: Uplink Interface'
          type: DEPENDENT
          key: u6.system.uplink.if
          history: 7d
          value_type: CHAR
          description: 'Current Uplink Interface (should be eth0 for wired).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.uplink
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Uplink Interface'
          triggers:
            - uuid: fa993d2fb8894698961b0cad88e9cf86
              expression: 'find(/Ubiquiti U6-IW/u6.system.uplink.if,,"like","eth0")=0'
              name: 'Device Uplink is NOT Wired (Mesh Mode?)'
              priority: WARNING
              description: 'The uplink interface is not eth0. The AP might be in Wireless Uplink (Mesh) mode.'
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Status
        - uuid: 534f60502e814ac89ebc9424e8035e22
          name: 'WLAN Clients: WiFi 5 (11ac)'
          type: DEPENDENT
          key: 'u6.wlan.clients.count[ac]'
          value_type: FLOAT
          description: 'Number of clients connected using WiFi 5 (11ac).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.ac
          master_item:
            key: u6.wlan.clients.distribution.json
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: 804c397e18894b4e87a227a8dc784f37
          name: 'WLAN Clients: Legacy (11a/b/g)'
          type: DEPENDENT
          key: 'u6.wlan.clients.count[legacy]'
          value_type: FLOAT
          description: 'Number of clients connected using Legacy (11a/b/g).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.legacy
          master_item:
            key: u6.wlan.clients.distribution.json
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: 5962e9fbb66a41d5907a5c4abb9074fa
          name: 'WLAN Clients: WiFi 4 (11n)'
          type: DEPENDENT
          key: 'u6.wlan.clients.count[n]'
          value_type: FLOAT
          description: 'Number of clients connected using WiFi 4 (11n).'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.n
          master_item:
            key: u6.wlan.clients.distribution.json
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: 5df585cce3ea48cd8c902c27e31b673d
          name: 'WLAN: Client Technology Distribution (JSON)'
          type: DEPENDENT
          key: u6.wlan.clients.distribution.json
          history: '0'
          value_type: TEXT
          description: 'Helper item to count clients by WiFi generation.'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var s = {ax:0, ac:0, n:0, legacy:0, total:0};
                  if(data.vap_table){
                    data.vap_table.forEach(function(v){
                      if(v.sta_table){
                        v.sta_table.forEach(function(c){
                          s.total++;
                          if(c.is_11ax) s.ax++;
                          else if(c.is_11ac) s.ac++;
                          else if(c.is_11n) s.n++;
                          else s.legacy++;
                        });
                      }
                    });
                  }
                  return JSON.stringify(s);
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Wireless Clients'
        - uuid: 54937e54ecf64c318f454adb11b2827e
          name: 'Management: Controller Connection State'
          type: DEPENDENT
          key: unifi.controller.state
          history: 7d
          value_type: FLOAT
          trends: '0'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.state
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 10m
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Remote Access'
          triggers:
            - uuid: b2dacd771b894fc0a4cfca017a608d9a
              expression: 'last(/Ubiquiti U6-IW/unifi.controller.state)<>2'
              name: 'Device Disconnected from Controller (State is not Provisioned)'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Management
        - uuid: 5c639543f92c44d5a20bc31331728289
          name: 'Management: Controller URL'
          type: DEPENDENT
          key: unifi.inform.url
          history: 7d
          value_type: CHAR
          description: 'Inform URL'
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.inform_url
            - type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 6h
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: Management
        - uuid: 2a4774e792dc4866802e16d5e0c2b7c6
          name: 'System: Memory Used'
          type: DEPENDENT
          key: vm.memory.util
          history: 7d
          value_type: FLOAT
          units: '%'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  var data = JSON.parse(value);
                  var used = data.sys_stats.mem_used;
                  var total = data.sys_stats.mem_total;
                  return (used / total) * 100;
          master_item:
            key: 'ssh.run[mca_dump]'
          tags:
            - tag: Monitoring
              value: 'Memory Usage'
      discovery_rules:
        - uuid: 1c7a9f6d4aa042e0ba33f32d1aaf94e5
          name: 'Port Discovery (mca-dump)'
          type: DEPENDENT
          key: net.if.discovery.mca
          item_prototypes:
            - uuid: 72a898e07caa4a88a2882d9e473f9a44
              name: 'Interface Port {#IFNAME}: LLDP Remote Chassis ID'
              type: DEPENDENT
              key: 'lldp.chassis[{#IFNAME}]'
              history: 7d
              value_type: CHAR
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var portIdx = '{#IFNAME}'; 
                      var val = '';
                      if (data.lldp_table) {
                          for (var i = 0; i < data.lldp_table.length; i++) {
                              if (data.lldp_table[i].local_port_idx == portIdx) {
                                  val = data.lldp_table[i].chassis_id;
                                  break;
                              }
                          }
                      }
                      return val;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Neighbors'
            - uuid: 62235ba0320049c1ab9929a350ab17f2
              name: 'Interface Port {#IFNAME}: LLDP Remote Port ID'
              type: DEPENDENT
              key: 'lldp.port[{#IFNAME}]'
              history: 7d
              value_type: CHAR
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var portIdx = '{#IFNAME}';
                      var val = '';
                      if (data.lldp_table) {
                          for (var i = 0; i < data.lldp_table.length; i++) {
                              if (data.lldp_table[i].local_port_idx == portIdx) {
                                  val = data.lldp_table[i].port_id;
                                  break;
                              }
                          }
                      }
                      return val;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1d
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Neighbors'
            - uuid: df022a1b734b4624adea8b4ac8c16fa5
              name: 'Interface Port {#IFNAME}: Inbound Broadcast Packets'
              type: DEPENDENT
              key: 'net.if.in.broadcast[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: pps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].rx_broadcast.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-1'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic Types'
              trigger_prototypes:
                - uuid: 96321339270f4bffab324be0f46e6e38
                  expression: 'avg(/Ubiquiti U6-IW/net.if.in.broadcast[{#IFNAME}],5m) > 2000'
                  name: 'Interface {#IFNAME}: Possible Broadcast Storm'
                  priority: HIGH
                  manual_close: 'YES'
            - uuid: 6498dc141ce342bd901969f56163873f
              name: 'Interface Port {#IFNAME}: Inbound Dropped Packets'
              type: DEPENDENT
              key: 'net.if.in.dropped[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].rx_dropped.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-1'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Errors'
            - uuid: 7ece33514a6d42818c791499566bd440
              name: 'Interface Port {#IFNAME}: Inbound Errors'
              type: DEPENDENT
              key: 'net.if.in.errors[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].rx_errors.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-1'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Errors'
            - uuid: 95a76343883a4112859a3569f2505c17
              name: 'Interface Port {#IFNAME}: Inbound Multicast Packets'
              type: DEPENDENT
              key: 'net.if.in.multicast[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: pps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].rx_multicast.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-1'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic Types'
            - uuid: ab56e7a88bae4faebc2e9c23c7d35da3
              name: 'Interface Port {#IFNAME}: Inbound Unicast Packets'
              type: DEPENDENT
              key: 'net.if.in.unicast[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: pps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].rx_packets.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-1'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic Types'
            - uuid: ac619f54f46447fea163ca111122b89d
              name: 'Interface Port {#IFNAME}: Inbound Traffic'
              type: DEPENDENT
              key: 'net.if.in[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-8'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic'
            - uuid: 102a3aaa8b0643169f751ed27f8fb5b3
              name: 'Interface Port {#IFNAME}: Outbound Broadcast Packets'
              type: DEPENDENT
              key: 'net.if.out.broadcast[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: pps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].tx_broadcast.first()'
                - type: CHANGE_PER_SECOND
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '500000000'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic Types'
            - uuid: 34ae3e413b1c4f88acb78111a8d10547
              name: 'Interface Port {#IFNAME}: Outbound Dropped Packets'
              type: DEPENDENT
              key: 'net.if.out.dropped[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].tx_dropped.first()'
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Errors'
            - uuid: 46ae36b7fbd3449d936148b1c6a6df5b
              name: 'Interface Port {#IFNAME}: Outbound Errors'
              type: DEPENDENT
              key: 'net.if.out.errors[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].tx_errors.first()'
                - type: CHANGE_PER_SECOND
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Errors'
            - uuid: 2e93306218e34ce3a390c43b3a643a1c
              name: 'Interface Port {#IFNAME}: Outbound Multicast Packets'
              type: DEPENDENT
              key: 'net.if.out.multicast[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: pps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].tx_multicast.first()'
                - type: CHANGE_PER_SECOND
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '500000000'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic Types'
            - uuid: 021b4dd6703e441faf380dc2be68a682
              name: 'Interface Port {#IFNAME}: Outbound Unicast Packets'
              type: DEPENDENT
              key: 'net.if.out.unicast[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: pps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].tx_packets.first()'
                - type: CHANGE_PER_SECOND
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '500000000'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic Types'
            - uuid: 406448608a634bddab9e6ea055adafec
              name: 'Interface Port {#IFNAME}: Outbound Traffic'
              type: DEPENDENT
              key: 'net.if.out[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '200000000000'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Traffic'
            - uuid: 45fe6ae40aea4b21a47d4384408e04cf
              name: 'Interface Port {#IFNAME}: Speed'
              type: DEPENDENT
              key: 'net.if.speed[{#IFNAME}]'
              history: 7d
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].speed.first()'
                - type: MULTIPLIER
                  parameters:
                    - '1000000'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Speed'
            - uuid: 1a42f569b84949fbb0ca44b323abf629
              name: 'Interface Port {#IFNAME}: Status'
              type: DEPENDENT
              key: 'net.if.status[{#IFNAME}]'
              history: 7d
              valuemap:
                name: 'Interface Status MCA'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].up.first()'
                - type: BOOL_TO_DECIMAL
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wired Interface Status'
              trigger_prototypes:
                - uuid: e9b5be693110424ba6013085f30ad9cd
                  expression: 'count(/Ubiquiti U6-IW/net.if.status[{#IFNAME}],10m,"ne","1") > 5'
                  name: 'Interface {#IFNAME}: Link is flapping'
                  priority: WARNING
            - uuid: d70ed4d7a7aa4076aa3df0496d201ff2
              name: 'Interface Port {#IFNAME}: STP State'
              type: DEPENDENT
              key: 'net.if.stp.state[{#IFNAME}]'
              history: 7d
              value_type: CHAR
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.port_table[?(@.port_idx==''{#IFNAME}'')].stp_state.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: STP
          trigger_prototypes:
            - uuid: 45855253bb2d4fada140da3cf70c5fb8
              expression: 'abs(min(/Ubiquiti U6-IW/net.if.in[{#IFNAME}],5m)) > (last(/Ubiquiti U6-IW/net.if.speed[{#IFNAME}]) * 0.95) and last(/Ubiquiti U6-IW/net.if.speed[{#IFNAME}]) > 0'
              name: 'Interface Port {#IFNAME}: Critical Inbound Bandwidth Usage (>95%)'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Bandwidth
            - uuid: 4663ff4931d0401bb9fdea9bf432a556
              expression: 'min(/Ubiquiti U6-IW/net.if.out[{#IFNAME}],5m) > (last(/Ubiquiti U6-IW/net.if.speed[{#IFNAME}]) * 0.95) and last(/Ubiquiti U6-IW/net.if.speed[{#IFNAME}]) > 0'
              name: 'Interface Port {#IFNAME}: Critical Outbound Bandwidth Usage (>95%)'
              priority: HIGH
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Bandwidth
            - uuid: b97e922fcbaf441982de203957dea723
              expression: 'abs(min(/Ubiquiti U6-IW/net.if.in[{#IFNAME}],5m)) > (last(/Ubiquiti U6-IW/net.if.speed[{#IFNAME}]) * 0.85) and last(/Ubiquiti U6-IW/net.if.speed[{#IFNAME}]) > 0'
              name: 'Interface Port {#IFNAME}: High Inbound Bandwidth Usage (>85%)'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Bandwidth
            - uuid: d8601bf726c64c20842150dd3afad86a
              expression: 'min(/Ubiquiti U6-IW/net.if.out[{#IFNAME}],5m) > (last(/Ubiquiti U6-IW/net.if.speed[{#IFNAME}]) * 0.85) and last(/Ubiquiti U6-IW/net.if.speed[{#IFNAME}]) > 0'
              name: 'Interface Port {#IFNAME}: High Outbound Bandwidth Usage (>85%)'
              priority: WARNING
              manual_close: 'YES'
              tags:
                - tag: Monitoring
                  value: Bandwidth
            - uuid: d3996de87f6e4b02bdc4489d60abf679
              expression: '(last(/Ubiquiti U6-IW/net.if.in.errors[{#IFNAME}]) - min(/Ubiquiti U6-IW/net.if.in.errors[{#IFNAME}],1h)) > 10 or (last(/Ubiquiti U6-IW/net.if.out.errors[{#IFNAME}]) - min(/Ubiquiti U6-IW/net.if.out.errors[{#IFNAME}],1h)) > 10'
              name: 'Interface {#IFNAME}: High Error Rate (Bad Cable?)'
              priority: AVERAGE
          graph_prototypes:
            - uuid: f6181435d79145a185a8ce39b3a10ccf
              name: 'Interface Port {#IFNAME}: Dropped Packets'
              graph_items:
                - drawtype: FILLED_REGION
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.in.dropped[{#IFNAME}]'
                - sortorder: '1'
                  drawtype: FILLED_REGION
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.out.dropped[{#IFNAME}]'
            - uuid: f19caf405ebe4bf19b4f6681d9f40cb1
              name: 'Interface Port {#IFNAME}: Traffic'
              graph_items:
                - drawtype: FILLED_REGION
                  color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.in[{#IFNAME}]'
                - sortorder: '1'
                  drawtype: FILLED_REGION
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.out[{#IFNAME}]'
            - uuid: 116a4d9abc8f468bbd411c0ad8a30581
              name: 'Interface Port {#IFNAME}: Traffic Types'
              yaxismax: '0'
              show_work_period: 'NO'
              show_triggers: 'NO'
              graph_items:
                - color: FF4000
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.in.broadcast[{#IFNAME}]'
                - sortorder: '1'
                  color: FFBF00
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.in.multicast[{#IFNAME}]'
                - sortorder: '2'
                  color: 80FF00
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.in.unicast[{#IFNAME}]'
                - sortorder: '3'
                  color: FF4000
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.out.broadcast[{#IFNAME}]'
                - sortorder: '4'
                  color: FFBF00
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.out.multicast[{#IFNAME}]'
                - sortorder: '5'
                  color: 80FF00
                  calc_fnc: MIN
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.if.out.unicast[{#IFNAME}]'
          master_item:
            key: 'ssh.run[mca_dump]'
          lld_macro_paths:
            - lld_macro: '{#IFALIAS}'
              path: $.name
            - lld_macro: '{#IFNAME}'
              path: $.port_idx
          preprocessing:
            - type: JSONPATH
              parameters:
                - $.port_table
        - uuid: 73dbdf4ab9d94c7ab9e1e5bba56ea3c3
          name: 'Device Tracking Discovery (ARP/IP)'
          type: DEPENDENT
          key: net.tracking.discovery
          lifetime_type: DELETE_IMMEDIATELY
          item_prototypes:
            - uuid: fbe7156e55bb4c82b5aa9cd67ad8c3cd
              name: 'Device on Port {#PORT_IDX}: {#IP_ADDR}'
              type: DEPENDENT
              key: 'net.tracking.device[{#PORT_IDX},{#IP_ADDR},{#MAC_ADDR}]'
              history: '0'
              value_type: CHAR
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var targetIp = '{#IP_ADDR}';
                      var targetMac = '{#MAC_ADDR}';
                      var type = '{#TYPE}'; // 'wired' or 'wireless'
                      var foundMac = '';
                      
                      if (type === 'wired' && data.port_table) {
                          for (var i=0; i<data.port_table.length; i++) {
                              if (data.port_table[i].mac_table) {
                                  for (var j=0; j<data.port_table[i].mac_table.length; j++) {
                                      var m = data.port_table[i].mac_table[j];
                                      if (m.ip == targetIp && m.mac == targetMac) {
                                          return m.mac;
                                      }
                                  }
                              }
                          }
                      } 
                      else if (type === 'wireless' && data.vap_table) {
                          for (var i=0; i<data.vap_table.length; i++) {
                              if (data.vap_table[i].sta_table) {
                                  for (var j=0; j<data.vap_table[i].sta_table.length; j++) {
                                      var s = data.vap_table[i].sta_table[j];
                                      if (s.ip == targetIp && s.mac == targetMac) {
                                          return s.mac;
                                      }
                                  }
                              }
                          }
                      }
                      
                      return foundMac;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: ARP
                - tag: Monitoring
                  value: 'Device Tracking'
          master_item:
            key: 'ssh.run[mca_dump]'
          preprocessing:
            - type: JAVASCRIPT
              parameters:
                - |
                  
                  var data = JSON.parse(value);
                  var output = [];
                  
                  // Wired
                  if (data.port_table) {
                      for (var i = 0; i < data.port_table.length; i++) {
                          var port = data.port_table[i];
                          if (port.mac_table) {
                              for (var j = 0; j < port.mac_table.length; j++) {
                                  var entry = port.mac_table[j];
                                  if (entry.ip && entry.ip !== '0.0.0.0') {
                                      output.push({
                                          '{#PORT_IDX}': port.port_idx,
                                          '{#IP_ADDR}': entry.ip,
                                          '{#MAC_ADDR}': entry.mac,
                                          '{#VLAN_ID}': entry.vlan,
                                          '{#TYPE}': 'wired'
                                      });
                                  }
                              }
                          }
                      }
                  }
                  
                  // Wireless
                  if (data.vap_table) {
                      for (var i = 0; i < data.vap_table.length; i++) {
                          var vap = data.vap_table[i];
                          if (vap.sta_table) {
                              for (var j = 0; j < vap.sta_table.length; j++) {
                                  var entry = vap.sta_table[j];
                                  if (entry.ip && entry.ip !== '0.0.0.0') {
                                      var portName = (vap.essid || 'Unknown') + ' (' + (vap.radio || '?') + ')';
                                      output.push({
                                          '{#PORT_IDX}': portName,
                                          '{#IP_ADDR}': entry.ip,
                                          '{#MAC_ADDR}': entry.mac,
                                          '{#VLAN_ID}': (entry.vlan_id !== undefined) ? entry.vlan_id : entry.vlan,
                                          '{#TYPE}': 'wireless'
                                      });
                                  }
                              }
                          }
                      }
                  }
                  
                  return JSON.stringify(output);
                  
        - uuid: 6e7f11de23c64d19a99b2803bc783e3f
          name: 'Radio Discovery (Physical)'
          type: DEPENDENT
          key: u6.radio.discovery
          item_prototypes:
            - uuid: 76e8ad315f4c449fa790bd80d746af69
              name: 'Radio {#RADIO}: Current Channel'
              type: DEPENDENT
              key: 'u6.radio.channel[{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var rName = '{#RADIO}';
                      var val = 0;
                      // Try Radio Table first
                      if (data.radio_table) {
                          for (var i = 0; i < data.radio_table.length; i++) {
                              if (data.radio_table[i].name === rName && data.radio_table[i].channel !== undefined && data.radio_table[i].channel !== 0) {
                                  val = data.radio_table[i].channel;
                                  return val;
                              }
                          }
                      }
                      // Fallback to VAP Table
                      if (data.vap_table) {
                          for (var i = 0; i < data.vap_table.length; i++) {
                              if (data.vap_table[i].radio_name === rName || data.vap_table[i].radio === rName) {
                                  if (data.vap_table[i].channel !== undefined) {
                                      val = data.vap_table[i].channel;
                                      return val; 
                                  }
                              }
                          }
                      }
                      return val;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 12h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Radio Configuration'
            - uuid: d4d3bee1942a4251a4f02e56a034bac4
              name: 'Radio {#RADIO}: EIRP (Total Radiated Power)'
              type: DEPENDENT
              key: 'u6.radio.eirp[{#RADIO}]'
              value_type: FLOAT
              units: dBm
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var rName = '{#RADIO}';
                      var tx = 0; 
                      var gain = 0;
                      var foundTx = false;
                      // 1. Try Radio Table
                      if (data.radio_table) {
                          for (var i = 0; i < data.radio_table.length; i++) {
                              if (data.radio_table[i].name === rName && data.radio_table[i].tx_power !== undefined && data.radio_table[i].tx_power !== null) {
                                  tx = data.radio_table[i].tx_power;
                                  foundTx = true;
                                  break;
                              }
                          }
                      }
                      // 2. Fallback: Try VAP Table
                      if (!foundTx && data.vap_table) {
                          for (var i = 0; i < data.vap_table.length; i++) {
                              if ((data.vap_table[i].radio_name === rName || data.vap_table[i].radio === rName) && data.vap_table[i].tx_power !== undefined) {
                                  tx = data.vap_table[i].tx_power;
                                  foundTx = true;
                                  break; 
                              }
                          }
                      }
                      // 3. Get Antenna Gain
                      if (data.antenna_table && data.antenna_table[0]) {
                          var key = rName + '_gain';
                          if (data.antenna_table[0][key] !== undefined) {
                              gain = data.antenna_table[0][key];
                          }
                      }
                      return tx + gain;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Radio Performance'
            - uuid: 822c65994b3b4ab3a8a08631b1090052
              name: 'Radio {#RADIO}: Channel Utilization (Total)'
              type: DEPENDENT
              key: 'u6.radio.utilization[{#RADIO}]'
              value_type: FLOAT
              units: '%'
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                      var data = JSON.parse(value);
                      var rName = '{#RADIO}';
                      var val = 0;
                      if (data.radio_table) {
                          for (var i = 0; i < data.radio_table.length; i++) {
                              if (data.radio_table[i].name === rName) {
                                  if (data.radio_table[i].cu_total !== undefined) {
                                      val = data.radio_table[i].cu_total;
                                  } else if (data.radio_table[i].athstats && data.radio_table[i].athstats.cu_total !== undefined) {
                                       val = data.radio_table[i].athstats.cu_total;
                                  }
                                  break;
                              }
                          }
                      }
                      return val;
                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 10m
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Radio Performance'
          master_item:
            key: 'ssh.run[mca_dump]'
          lld_macro_paths:
            - lld_macro: '{#RADIO}'
              path: $.name
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.radio_table[:]'
        - uuid: 7e2941ac337949d8a7c6a25c46b337bf
          name: 'SSID (VAP) Discovery'
          type: DEPENDENT
          key: u6.vap.discovery
          item_prototypes:
            - uuid: 4d32d36d89344b2eac63264c903d8504
              name: 'Inbound Traffic on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'net.vap.in[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].rx_bytes.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '-8'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Traffic'
            - uuid: 2d80107e5d904f3690dc1e0929d1936c
              name: 'Outbound Traffic on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'net.vap.out[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              units: bps
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].tx_bytes.first()'
                - type: CHANGE_PER_SECOND
                - type: MULTIPLIER
                  parameters:
                    - '8'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Traffic'
            - uuid: 89ba5692056b46efa12caa441f5c9163
              name: 'Anomaly: ARP Timeout on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.arp_timeout[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma, akik nem kapnak választ ARP kérésre (sta_arp_timeout). Gateway probléma lehet.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.sta_arp_timeout.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 15ae923f248c4bed9958d6cd9367fab3
                  expression: 'min(/Ubiquiti U6-IW/u6.vap.anomaly.arp_timeout[{#ESSID},{#RADIO}],5m)>0'
                  name: 'Network Issue ({#ESSID}): ARP Timeout (Gateway unreachable?)'
                  priority: HIGH
            - uuid: 7f7723c2eb0b4ebaa2fa84aa9d1e1891
              name: 'DHCP Failures on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.dhcp[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.no_dhcp_response.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: b762d05812d1498a92bf70cde9120844
                  expression: 'min(/Ubiquiti U6-IW/u6.vap.anomaly.dhcp[{#ESSID},{#RADIO}],5m)>0'
                  name: 'DHCP Issue on WiFi ({#ESSID}): Clients not receiving IP'
                  priority: DISASTER
                  manual_close: 'YES'
            - uuid: 7d1fc1439a2b45d2bfd64cc776d3d40f
              name: 'Anomaly: High Disconnect Count on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.disconnects[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Gyakori lecsatlakozások száma (high_disconnect_count).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_disconnect_count.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: f2136c954de946d1a45dcedc25490a99
              name: 'High DNS Latency on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.dns[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_dns_latency.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 52cb36958a06400d9ea2717216aabf9d
                  expression: 'min(/Ubiquiti U6-IW/u6.vap.anomaly.dns[{#ESSID},{#RADIO}],5m)>0'
                  name: 'High DNS Latency on {#ESSID} ({#RADIO})'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: 087946c6cb9245aa85b86c319c907649
              name: 'Anomaly: DNS Timeout on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.dns_timeout[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma, akik egyáltalán nem kapnak választ a DNS szervertől (sta_dns_timeout).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.sta_dns_timeout.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 11dbfb56a504453db8ccacd2fc5bdf9b
              name: 'High ICMP Latency on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.icmp[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_icmp_rtt.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 9102500696d24364b6d08ed2cb07bd9d
                  expression: 'min(/Ubiquiti U6-IW/u6.vap.anomaly.icmp[{#ESSID},{#RADIO}],5m)>0'
                  name: 'High ICMP Latency on {#ESSID} ({#RADIO})'
                  priority: AVERAGE
                  manual_close: 'YES'
            - uuid: e4b5192e04664531a3e79c68bf9c9b5b
              name: 'Anomaly: Low PHY Rate on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.low_phy[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma nagyon alacsony fizikai kapcsolati sebességgel (low_phy_rate).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.low_phy_rate.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 6972f45d413d46ba82b48bc83cfeb782
              name: 'Anomaly: Sleepy Clients on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.sleepy[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek, amelyek energiatakarékos módban ragadtak vagy nem válaszolnak (sleepy_client).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.sleepy_client.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 68a4b1afbba64588871390d46a345bc7
              name: 'Anomaly: High TCP Latency on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.tcp_latency[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma magas TCP késleltetéssel. Ez lassú webböngészést okoz.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_tcp_latency.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: c89a54f22a9a4521878c28d145876999
              name: 'Anomaly: TCP Packet Loss on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.tcp_loss[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma TCP csomagvesztéssel (high_tcp_packet_loss).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_tcp_packet_loss.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 5e856b76e02b483db30badc0fb616a83
              name: 'Weak Signal Clients on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.weak_signal[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.weak_signal.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: e8a92e1119b74148a1a5e1808c70ae4d
                  expression: 'last(/Ubiquiti U6-IW/u6.vap.anomaly.weak_signal[{#ESSID},{#RADIO}],#5)>5'
                  name: 'Weak Signal Clients on {#ESSID} ({#RADIO}'
                  priority: INFO
            - uuid: ec88b6dc57a344efae19757076f795fd
              name: 'Anomaly: WiFi Drops on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.wifi_drops[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Azon kliensek száma, akiknél a Wi-Fi kapcsolat váratlanul megszakadt (high_wifi_drops).'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_wifi_drops.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
              trigger_prototypes:
                - uuid: 97727c7426d4446a87d8d40b7092ebf0
                  expression: 'min(/Ubiquiti U6-IW/u6.vap.anomaly.wifi_drops[{#ESSID},{#RADIO}],5m)>2'
                  name: 'Unstable WiFi ({#ESSID}): Multiple Clients Dropping Connection'
                  priority: HIGH
                  manual_close: 'YES'
            - uuid: 8670e6569a904802a4825542ebd6ad7c
              name: 'Anomaly: High WiFi Retries on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.anomaly.wifi_retries[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              description: 'Kliensek száma magas újraküldési aránnyal (high_wifi_retries). Ez erős interferenciára vagy távoli kliensekre utal.'
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].anomalies_bar_chart_now.high_wifi_retries.first()'
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 2bc7b51613c142bf98b241d7fdec6664
              name: 'Clients on {#ESSID} ({#RADIO})'
              type: DEPENDENT
              key: 'u6.vap.clients[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].num_sta.first()'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: SSID
                - tag: Monitoring
                  value: 'Wireless Clients'
            - uuid: 5704e639f1234f74abfb482f316cd275
              name: 'Satisfaction Score on {#ESSID}'
              type: DEPENDENT
              key: 'u6.vap.satisfaction[{#ESSID},{#RADIO}]'
              value_type: FLOAT
              preprocessing:
                - type: JSONPATH
                  parameters:
                    - '$.vap_table[?(@.essid==''{#ESSID}'' && @.radio==''{#RADIO}'')].satisfaction.first()'
                - type: IN_RANGE
                  parameters:
                    - '0'
                    - '100'
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: SSID
            - uuid: c1efb3d52f2c4cf2ae8ca00f3ced8288
              name: 'Anomaly: ARP Timeout on {#VAP_NAME}'
              type: DEPENDENT
              key: 'u6.wlan.anomaly.arp[{#VAP_NAME}]'
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                                      var data = JSON.parse(value);
                                      var vapName = '{#VAP_NAME}';
                                      var val = 0;
                                      if (data.vap_table) {
                                          for(var i=0; i<data.vap_table.length; i++) {
                                              var v = data.vap_table[i];
                                              var vName = (v.essid || 'Unknown') + ' (' + (v.radio || '?') + ')';
                                              if (vName === vapName) {
                                                  // Found VAP. Check anomalies.
                                                  if (v.anomalies_bar_chart) {
                                                      // path like anomalies_bar_chart.dhcp_timeout
                                                      var metric = v.anomalies_bar_chart.arp_timeout;
                                                      if (metric !== undefined) val = metric;
                                                  }
                                                  break;
                                              }
                                          }
                                      }
                                      return val;
                                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 35b7c0a9b9014b5c861fa36bd67f6d53
              name: 'Anomaly: DHCP Failures on {#VAP_NAME}'
              type: DEPENDENT
              key: 'u6.wlan.anomaly.dhcp[{#VAP_NAME}]'
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                                      var data = JSON.parse(value);
                                      var vapName = '{#VAP_NAME}';
                                      var val = 0;
                                      if (data.vap_table) {
                                          for(var i=0; i<data.vap_table.length; i++) {
                                              var v = data.vap_table[i];
                                              var vName = (v.essid || 'Unknown') + ' (' + (v.radio || '?') + ')';
                                              if (vName === vapName) {
                                                  // Found VAP. Check anomalies.
                                                  if (v.anomalies_bar_chart) {
                                                      // path like anomalies_bar_chart.dhcp_timeout
                                                      var metric = v.anomalies_bar_chart.dhcp_timeout;
                                                      if (metric !== undefined) val = metric;
                                                  }
                                                  break;
                                              }
                                          }
                                      }
                                      return val;
                                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: c7f2864a9c7f4723a4723c21a67e8f43
              name: 'Anomaly: DNS Timeout on {#VAP_NAME}'
              type: DEPENDENT
              key: 'u6.wlan.anomaly.dns[{#VAP_NAME}]'
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                                      var data = JSON.parse(value);
                                      var vapName = '{#VAP_NAME}';
                                      var val = 0;
                                      if (data.vap_table) {
                                          for(var i=0; i<data.vap_table.length; i++) {
                                              var v = data.vap_table[i];
                                              var vName = (v.essid || 'Unknown') + ' (' + (v.radio || '?') + ')';
                                              if (vName === vapName) {
                                                  // Found VAP. Check anomalies.
                                                  if (v.anomalies_bar_chart) {
                                                      // path like anomalies_bar_chart.dhcp_timeout
                                                      var metric = v.anomalies_bar_chart.dns_timeout;
                                                      if (metric !== undefined) val = metric;
                                                  }
                                                  break;
                                              }
                                          }
                                      }
                                      return val;
                                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 6fd9b0ef95be4f04914ac6ccf6a15c9a
              name: 'Anomaly: WiFi Drops on {#VAP_NAME}'
              type: DEPENDENT
              key: 'u6.wlan.anomaly.drops[{#VAP_NAME}]'
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                                      var data = JSON.parse(value);
                                      var vapName = '{#VAP_NAME}';
                                      var val = 0;
                                      if (data.vap_table) {
                                          for(var i=0; i<data.vap_table.length; i++) {
                                              var v = data.vap_table[i];
                                              var vName = (v.essid || 'Unknown') + ' (' + (v.radio || '?') + ')';
                                              if (vName === vapName) {
                                                  // Found VAP. Check anomalies.
                                                  if (v.anomalies_bar_chart) {
                                                      // path like anomalies_bar_chart.dhcp_timeout
                                                      var metric = v.anomalies_bar_chart.wifi_retries;
                                                      if (metric !== undefined) val = metric;
                                                  }
                                                  break;
                                              }
                                          }
                                      }
                                      return val;
                                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: 6cdb22677f844ca1a4cc6cea2ddcf22c
              name: 'Anomaly: High WiFi Retries on {#VAP_NAME}'
              type: DEPENDENT
              key: 'u6.wlan.anomaly.retries[{#VAP_NAME}]'
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                                      var data = JSON.parse(value);
                                      var vapName = '{#VAP_NAME}';
                                      var val = 0;
                                      if (data.vap_table) {
                                          for(var i=0; i<data.vap_table.length; i++) {
                                              var v = data.vap_table[i];
                                              var vName = (v.essid || 'Unknown') + ' (' + (v.radio || '?') + ')';
                                              if (vName === vapName) {
                                                  // Found VAP. Check anomalies.
                                                  if (v.anomalies_bar_chart) {
                                                      // path like anomalies_bar_chart.dhcp_timeout
                                                      var metric = v.anomalies_bar_chart.high_wifi_retries;
                                                      if (metric !== undefined) val = metric;
                                                  }
                                                  break;
                                              }
                                          }
                                      }
                                      return val;
                                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
            - uuid: edc636c8f3dc49a683deb122c1c53a06
              name: 'Anomaly: High TCP Latency on {#VAP_NAME}'
              type: DEPENDENT
              key: 'u6.wlan.anomaly.tcp_latency[{#VAP_NAME}]'
              value_type: FLOAT
              preprocessing:
                - type: JAVASCRIPT
                  parameters:
                    - |
                      
                                      var data = JSON.parse(value);
                                      var vapName = '{#VAP_NAME}';
                                      var val = 0;
                                      if (data.vap_table) {
                                          for(var i=0; i<data.vap_table.length; i++) {
                                              var v = data.vap_table[i];
                                              var vName = (v.essid || 'Unknown') + ' (' + (v.radio || '?') + ')';
                                              if (vName === vapName) {
                                                  // Found VAP. Check anomalies.
                                                  if (v.anomalies_bar_chart) {
                                                      // path like anomalies_bar_chart.dhcp_timeout
                                                      var metric = v.anomalies_bar_chart.high_tcp_latency;
                                                      if (metric !== undefined) val = metric;
                                                  }
                                                  break;
                                              }
                                          }
                                      }
                                      return val;
                                      
                - type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              master_item:
                key: 'ssh.run[mca_dump]'
              tags:
                - tag: Monitoring
                  value: 'Wireless Anomalies'
          graph_prototypes:
            - uuid: 889b0fe1f48844f1a3da51d2f8359480
              name: 'Anomalies on {#ESSID} ({#RADIO})'
              yaxismax: '0'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.arp_timeout[{#ESSID},{#RADIO}]'
                - sortorder: '1'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.dns_timeout[{#ESSID},{#RADIO}]'
                - sortorder: '2'
                  color: F63100
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.disconnects[{#ESSID},{#RADIO}]'
                - sortorder: '3'
                  color: 2774A4
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.tcp_latency[{#ESSID},{#RADIO}]'
                - sortorder: '4'
                  color: A54F10
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.wifi_retries[{#ESSID},{#RADIO}]'
                - sortorder: '5'
                  color: FC6EA3
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.low_phy[{#ESSID},{#RADIO}]'
                - sortorder: '6'
                  color: 6C59DC
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.sleepy[{#ESSID},{#RADIO}]'
                - sortorder: '7'
                  color: AC8C14
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.tcp_loss[{#ESSID},{#RADIO}]'
                - sortorder: '8'
                  color: 611F27
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.wifi_drops[{#ESSID},{#RADIO}]'
                - sortorder: '9'
                  color: F230E0
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.dhcp[{#ESSID},{#RADIO}]'
                - sortorder: '10'
                  color: 5CCD18
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.dns[{#ESSID},{#RADIO}]'
                - sortorder: '11'
                  color: BB2A02
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.anomaly.icmp[{#ESSID},{#RADIO}]'
            - uuid: 5fe891f71bf5458aba5d8728e0405bed
              name: 'Satisfaction Score on {#ESSID}'
              yaxismax: '0'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'u6.vap.satisfaction[{#ESSID},{#RADIO}]'
            - uuid: ccbb1b1d65bb4961abc6096cb8228dc4
              name: 'Traffic on {#ESSID} ({#RADIO})'
              yaxismax: '0'
              graph_items:
                - color: 1A7C11
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.vap.in[{#ESSID},{#RADIO}]'
                - sortorder: '1'
                  color: '274482'
                  calc_fnc: ALL
                  item:
                    host: 'Ubiquiti U6-IW'
                    key: 'net.vap.out[{#ESSID},{#RADIO}]'
          master_item:
            key: 'ssh.run[mca_dump]'
          lld_macro_paths:
            - lld_macro: '{#APMAC}'
              path: $.bssid
            - lld_macro: '{#ESSID}'
              path: $.essid
            - lld_macro: '{#RADIO}'
              path: $.radio
          preprocessing:
            - type: JSONPATH
              parameters:
                - '$.vap_table[:]'
      valuemaps:
        - uuid: 0c8b11a521994983b7e019a86bb87e80
          name: 'Interface Status'
          mappings:
            - value: '1'
              newvalue: Up
            - value: '2'
              newvalue: Down
            - value: '3'
              newvalue: Testing
        - uuid: 32bd74f6ee094919aaf8f7e9db988bd9
          name: 'Interface Status MCA'
          mappings:
            - value: '1'
              newvalue: Up
            - value: '0'
              newvalue: Down
  graphs:
    - uuid: 70bbb6121e5743b5a2bbe81414f871aa
      name: 'CPU Usage'
      yaxismax: '0'
      graph_items:
        - drawtype: FILLED_REGION
          color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: system.cpu.util
    - uuid: c94f425c6195448f8da2b4cbe6fee83d
      name: 'Load AVG'
      yaxismax: '0'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: 'u6.system.load[1]'
        - sortorder: '1'
          color: '274482'
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: 'u6.system.load[5]'
        - sortorder: '2'
          color: F63100
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: 'u6.system.load[15]'
    - uuid: 77caddafb9b34d43a0d529e99361c2ad
      name: 'Mac Address Table Size'
      yaxismax: '0'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: system.mac.table.size
    - uuid: 72eaf340c3034c1e9363d2ba2d8c3eab
      name: 'Memory Usage'
      yaxismax: '0'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: vm.memory.util
    - uuid: 70910357b338468b96583e71813817e9
      name: Ping
      yaxismax: '0'
      graph_items:
        - drawtype: FILLED_REGION
          color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: icmpping
    - uuid: 43c71505161f4f3eb9b69f094423d3af
      name: 'Wireless Client Technology'
      yaxismax: '0'
      graph_items:
        - color: 1A7C11
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: 'u6.wlan.clients.count[legacy]'
        - sortorder: '1'
          color: '274482'
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: 'u6.wlan.clients.count[n]'
        - sortorder: '2'
          color: F63100
          calc_fnc: ALL
          item:
            host: 'Ubiquiti U6-IW'
            key: 'u6.wlan.clients.count[ac]'
